var a=JSON.stringify({timestamp:1711722655180,code:200,content:{controllerDetails:{dpo:{name:'',contact:''},name:'https://api.visionstrust.com/v1/catalog/participants/656dfb3e282d47cfa6b66b30',contact:'',representative:''},internationalTransfers:{countries:[],safeguards:''},automatedDecisionMaking:{details:''},_id:'65e9f407de244c2a18764332',contract:{_id:'65e9d4911c2c6c79dfb2b090',ecosystem:'https://api.visionstrust.com/v1/catalog/ecosystems/65e9d48e1b31ce8b0f98d2a1',orchestrator:'https://api.visionstrust.com/v1/catalog/participants/656dfb3e282d47cfa6b66b30',rolesAndObligations:[],status:'pending',serviceOfferings:[{participant:'656dfb3e282d47cfa6b66b2a',serviceOffering:'65e9d5b01b31ce8b0f9901b6',policies:[{description:'MUST not use data for more than n times',permission:[{action:'use',target:'65e9d5b01b31ce8b0f9901b6',constraint:[{leftOperand:'count',operator:'lt',rightOperand:10}]}],prohibition:[]}],_id:'65e9d6681c2c6c79dfb2b0b8'},{participant:'https://api.visionstrust.com/v1/catalog/participants/656dfb3e282d47cfa6b66b2a',serviceOffering:'https://api.visionstrust.com/v1/catalog/serviceofferings/65e9d5b01b31ce8b0f9901b6',policies:[{description:'MUST not use data for more than n times',permission:[{action:'use',target:'https://api.visionstrust.com/v1/catalog/serviceofferings/65e9d5b01b31ce8b0f9901b6',constraint:[{leftOperand:'count',operator:'lt',rightOperand:10}]}],prohibition:[]}],_id:'65e9d6721c2c6c79dfb2b0c9'},{participant:'https://api.visionstrust.com/v1/catalog/participants/656dfb3e282d47cfa6b66b30',serviceOffering:'https://api.visionstrust.com/v1/catalog/serviceofferings/65e9d62e1b31ce8b0f990259',policies:[{description:'MUST not use data for more than n times',permission:[{action:'use',target:'https://api.visionstrust.com/v1/catalog/serviceofferings/65e9d62e1b31ce8b0f990259',constraint:[{leftOperand:'count',operator:'lt',rightOperand:10}]}],prohibition:[]}],_id:'65e9d6b31c2c6c79dfb2b0f8'}],purpose:[],members:[{participant:'https://api.visionstrust.com/v1/catalog/participants/656dfb3e282d47cfa6b66b30',role:'orchestrator',signature:'hasSigned',date:'2024-03-07T14:52:15.092Z'},{participant:'https://api.visionstrust.com/v1/catalog/participants/656dfb3e282d47cfa6b66b2a',role:'participant',signature:'hasSigned',date:'2024-03-07T15:00:02.644Z'}],revokedMembers:[],createdAt:'2024-03-07T14:52:01.703Z',updatedAt:'2024-03-07T15:01:07.171Z',__v:3},lastUpdated:'1709831174551',dataProvider:{'@context':'https://api.visionstrust.com/v1/participant','@type':'Participant',_id:'656dfb3e282d47cfa6b66b30',did:null,legalName:'Test-DataProvider',legalPerson:{headquartersAddress:{countryCode:''},legalAddress:{countryCode:''},registrationNumber:'',parentOrganization:[],subOrganization:[]},termsAndConditions:'',associatedOrganisation:'5fe215ed1e4d92318a81f8f4',schema_version:'1',createdAt:'2023-12-04T16:16:01.369Z',updatedAt:'2024-02-23T15:53:24.254Z',__v:0,dataspaceConnectorAppKey:'79d9f583b828c4fc2830b6b33418fcdf12a4514b829c7a6e2b87de3bf1321b80c9fd3f3a47b862c6d46778c02d25fc74c4f43c63301dad802873ee6a76c270b7',dataspaceEndpoint:'https://provider-data-connector-253244a6c16c.herokuapp.com/'},purposes:[{'@context':'https://api.visionstrust.com/v1/serviceoffering','@type':'ServiceOffering',_id:'65e9d5b01b31ce8b0f9901b6',name:'consumer payload',providedBy:'656dfb3e282d47cfa6b66b2a',aggregationOf:['https://api.visionstrust.com/v1/catalog/softwareresources/65e9d5701b31ce8b0f990170'],dependsOn:[],policy:[{'@context':{xsd:'http://www.w3.org/2001/XMLSchema#',description:{'@id':'https://schema.org/description','@container':'@language'}},'@id':'https://registry.visionstrust.com/static/references/rules/rule-access-4.json',title:{'@type':'xsd/string','@value':'Count'},uid:'rule-access-4',name:'Count',description:[{'@value':'MUST not use data for more than n times','@language':'en'}],policy:{permission:[{action:'use',target:'@{target}',constraint:[{leftOperand:'count',operator:'lt',rightOperand:'@{value}'}]}]},requestedFields:['target','value']}],termsAndConditions:'',dataProtectionRegime:[],dataAccountExport:[],location:'World',description:'description',keywords:[],dataResources:[],softwareResources:[{'@context':'https://api.visionstrust.com/v1/softwareresource','@type':'SoftwareResource',_id:'65e9d5701b31ce8b0f990170',providedBy:'656dfb3e282d47cfa6b66b2a',name:'CONSUMER PAYLOAD',description:'pour demo avec payload',aggregationOf:[],copyrightOwnedBy:['https://api.visionstrust.com/v1/catalog/participants/656dfb3e282d47cfa6b66b2a'],license:[],policy:[{'@context':{xsd:'http://www.w3.org/2001/XMLSchema#',description:{'@id':'https://schema.org/description','@container':'@language'}},'@id':'http://localhost:3000/static/references/rules/rule-access-4.json',title:{'@type':'xsd/string','@value':'Count'},uid:'rule-access-4',name:'Count',description:[{'@value':'MUST not use data for more than n times','@language':'en'}],policy:{permission:[{action:'use',target:'@{target}',constraint:[{leftOperand:'count',operator:'lt',rightOperand:'@{value}'}]}]},requestedFields:['target','value']}],category:'5f8d9ea341184f59787e605a',locationAddress:[{countryCode:'World',_id:'65e9d5701b31ce8b0f990171'}],users_clients:0,demo_link:'',relevant_project_link:'',schema_version:'1.1.0',usePII:!0,isAPI:!0,createdAt:'2024-03-07T14:55:44.083Z',updatedAt:'2024-03-08T13:07:16.027Z',__v:0,representation:{_id:'65e9d57a1b31ce8b0f99017b',resourceID:'65e9d5701b31ce8b0f990170',type:'REST',url:'https://consumer-api-8d96fe5950ea.herokuapp.com/private/users/{userId}',method:'apiKey',credential:'65eb0c672797ea2d5076e3f2',createdAt:'2024-03-07T14:55:54.754Z',updatedAt:'2024-03-08T13:07:16.040Z',__v:0}}],archived:!1,visible:!0,pricing:'150',pricingModel:['https://registry.visionstrust.com/static/references/pricing-model/dataBased.json'],businessModel:['https://registry.visionstrust.com/static/references/business-model/freemium.json'],maximumConsumption:'',maximumPerformance:'',pricingDescription:'description',compliantServiceOfferingVC:'',serviceOfferingVC:'',schema_version:'1.1.0',createdAt:'2024-03-07T14:56:48.477Z',updatedAt:'2024-03-13T13:00:44.245Z',__v:0}],categoriesOfData:[],data:[{'@context':'https://api.visionstrust.com/v1/serviceoffering','@type':'ServiceOffering',_id:'65e9d62e1b31ce8b0f990259',name:'PROVIDER PAYLOAD',providedBy:'656dfb3e282d47cfa6b66b30',aggregationOf:['https://api.visionstrust.com/v1/catalog/dataresources/65e9d5f01b31ce8b0f990217'],dependsOn:[],policy:[{'@context':{xsd:'http://www.w3.org/2001/XMLSchema#',description:{'@id':'https://schema.org/description','@container':'@language'}},'@id':'https://registry.visionstrust.com/static/references/rules/rule-access-4.json',title:{'@type':'xsd/string','@value':'Count'},uid:'rule-access-4',name:'Count',description:[{'@value':'MUST not use data for more than n times','@language':'en'}],policy:{permission:[{action:'use',target:'@{target}',constraint:[{leftOperand:'count',operator:'lt',rightOperand:'@{value}'}]}]},requestedFields:['target','value']}],termsAndConditions:'',dataProtectionRegime:[],dataAccountExport:[],location:'World',description:'démo payload',keywords:[],dataResources:[{'@context':'https://api.visionstrust.com/v1/dataresource','@type':'DataResource',_id:'65e9d5f01b31ce8b0f990217',aggregationOf:[],name:'PROVIDER PAYLOAD',description:'démo payload',copyrightOwnedBy:['https://api.visionstrust.com/v1/catalog/participants/656dfb3e282d47cfa6b66b30'],license:[],policy:[{'@context':{xsd:'http://www.w3.org/2001/XMLSchema#',description:{'@id':'https://schema.org/description','@container':'@language'}},'@id':'http://localhost:3000/static/references/rules/rule-access-4.json',title:{'@type':'xsd/string','@value':'Count'},uid:'rule-access-4',name:'Count',description:[{'@value':'MUST not use data for more than n times','@language':'en'}],policy:{permission:[{action:'use',target:'@{target}',constraint:[{leftOperand:'count',operator:'lt',rightOperand:'@{value}'}]}]},requestedFields:['target','value']}],producedBy:'656dfb3e282d47cfa6b66b30',exposedThrough:[],obsoleteDateTime:'',expirationDateTime:'',containsPII:!0,anonymized_extract:'',archived:!1,attributes:[],category:'648353e51d2c11adaae558c1',isPayloadForAPI:!0,country_or_region:'World',entries:-1,subCategories:[],schema_version:'1',createdAt:'2024-03-07T14:57:52.808Z',updatedAt:'2024-03-08T13:09:07.332Z',__v:0,representation:{_id:'65e9d5f11b31ce8b0f99021e',resourceID:'65e9d5f01b31ce8b0f990217',fileType:'',type:'REST',url:'https://provider-api-a70765a220a4.herokuapp.com/private/users/{userId}',sqlQuery:'',className:'',method:'apiKey',credential:'65eb0b582c09fa278f93f16d',createdAt:'2024-03-07T14:57:53.354Z',updatedAt:'2024-03-08T13:09:07.338Z',__v:0},apiResponseRepresentation:{_id:'65e9e68c41a12b8077bb48b4',resourceID:'65e9d5f01b31ce8b0f990217',fileType:'',type:'REST',url:'https://provider-api-a70765a220a4.herokuapp.com/private/users/{userId}',sqlQuery:'',className:'',method:'apiKey',credential:'65eb0b582c09fa278f93f16d',createdAt:'2024-03-07T16:08:44.227Z',updatedAt:'2024-03-08T13:09:07.324Z',__v:0}}],softwareResources:[],archived:!1,visible:!0,pricing:'180',pricingModel:['https://registry.visionstrust.com/static/references/pricing-model/dataBased.json'],businessModel:['https://registry.visionstrust.com/static/references/business-model/freemium.json'],maximumConsumption:'',maximumPerformance:'',pricingDescription:'description',compliantServiceOfferingVC:'',serviceOfferingVC:'',schema_version:'1.1.0',createdAt:'2024-03-07T14:58:54.078Z',updatedAt:'2024-03-13T13:00:44.245Z',__v:0}],recipients:[{'@context':'https://api.visionstrust.com/v1/participant','@type':'Participant',_id:'656dfb3e282d47cfa6b66b2a',did:null,legalName:'Test-DataUser',legalPerson:{headquartersAddress:{countryCode:''},legalAddress:{countryCode:''},registrationNumber:'',parentOrganization:[],subOrganization:[]},termsAndConditions:'',associatedOrganisation:'5fb67b0445566b015587d39a',schema_version:'1',createdAt:'2023-12-04T16:16:01.350Z',updatedAt:'2024-02-22T17:32:44.167Z',__v:0,dataspaceConnectorAppKey:'0ced7b0ba124a02bf0e14251045b3a96a868478115f7acd7fc1b1631ddadbd3b87cff6a413f659e943e49889bf354942efe342fbe5e66487f3b38f5dbc4d9526',dataspaceEndpoint:'https://consumer-data-connector-753ad8ea2eaa.herokuapp.com/'}],retentionPeriod:'',piiPrincipalRights:[],withdrawalOfConsent:'',complaintRights:'',provisionRequirements:'',schema_version:'0.1.0',createdAt:'2024-03-07T17:06:15.965Z',updatedAt:'2024-03-07T17:06:15.965Z',__v:0}}),c={bold:'./node_modules/consent-modal-web-component/assets/font/KoHo-Bold.ttf',boldItalic:'./node_modules/consent-modal-web-component/assets/font/KoHo-BoldItalic.ttf',extraLight:'./node_modules/consent-modal-web-component/assets/font/KoHo-ExtraLight.ttf',extraLightItalic:'./node_modules/consent-modal-web-component/assets/font/KoHo-ExtraLightItalic.ttf',italic:'./node_modules/consent-modal-web-component/assets/font/KoHo-Italic.ttf',light:'./node_modules/consent-modal-web-component/assets/font/KoHo-Light.ttf',lightItalic:'./node_modules/consent-modal-web-component/assets/font/KoHo-LightItalic.ttf',medium:'./node_modules/consent-modal-web-component/assets/font/KoHo-Medium.ttf',mediumItalic:'./node_modules/consent-modal-web-component/assets/font/KoHo-MediumItalic.ttf',regular:'./node_modules/consent-modal-web-component/assets/font/KoHo-Regular.ttf',semiBold:'./node_modules/consent-modal-web-component/assets/font/KoHo-SemiBold.ttf',semiBoldItalic:'./node_modules/consent-modal-web-component/assets/font/KoHo-SemiBoldItalic.ttf'};var b=`
  <svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M13.2112 24.6875C20.0106 24.6875 25.5226 19.231 25.5226 12.5C25.5226 5.76903 20.0106 0.3125 13.2112 0.3125C6.41187 0.3125 0.899902 5.76903 0.899902 12.5C0.899902 19.231 6.41187 24.6875 13.2112 24.6875Z" fill="#17243F"/>
    <path d="M19.6817 9.18499C19.0327 9.18499 18.482 9.71149 18.482 10.355C18.482 10.6865 18.6197 10.979 18.8557 11.1935L15.1977 19.559C15.1583 19.637 15.0797 19.676 15.001 19.676H12.7393C12.6607 19.676 12.582 19.6175 12.5427 19.559L6.80001 6.49399L6.81967 6.45499H13.0147C13.1917 6.90349 13.6243 7.21549 14.116 7.21549C14.765 7.21549 15.3157 6.68899 15.3157 6.04549C15.3157 5.40199 14.7847 4.87549 14.116 4.87549C13.6047 4.87549 13.172 5.18749 13.0147 5.63599H6.83934C6.54434 5.63599 6.26901 5.77249 6.11167 6.02599C5.95434 6.25999 5.93467 6.57199 6.03301 6.84499L11.7757 19.91C11.933 20.2805 12.3263 20.534 12.7393 20.534H15.001C15.414 20.534 15.7877 20.2805 15.9647 19.91L19.6227 11.525C19.6423 11.525 19.662 11.525 19.6817 11.525C20.3307 11.525 20.8813 10.9985 20.8813 10.355C20.8813 9.71149 20.3503 9.18499 19.6817 9.18499Z" fill="url(#paint0_linear_146_454)"/>
    <path d="M10.1826 9.32153L13.8406 17.3555L17.4986 9.32153H10.1826ZM11.4806 10.1405H16.24L13.8603 15.3665L11.4806 10.1405Z" fill="url(#paint1_linear_146_454)"/>
    <defs>
    <linearGradient id="paint0_linear_146_454" x1="5.9777" y1="12.6974" x2="20.8786" y2="12.6974" gradientUnits="userSpaceOnUse">
    <stop stop-color="#DBFFAA"/>
    <stop offset="0.4385" stop-color="#08FFAD"/>
    <stop offset="1" stop-color="#00A2AE"/>
    </linearGradient>
    <linearGradient id="paint1_linear_146_454" x1="10.1907" y1="13.3428" x2="17.5223" y2="13.3428" gradientUnits="userSpaceOnUse">
    <stop stop-color="#DBFFAA"/>
    <stop offset="0.4385" stop-color="#08FFAD"/>
    <stop offset="1" stop-color="#00A2AE"/>
    </linearGradient>
    </defs>
    </svg>
  `;class ConsentModal extends HTMLElement{constructor(){super();this.attachShadow({mode:'open'});this.PDCAdminJWT=this.getAttribute('data-PDCAdminJWT');this.availableExchangesEndpoint=this.getAttribute('data-availableExchangesEndpoint');this.privacyNoticeEndpoint=this.getAttribute('data-privacyNoticeEndpoint');this.consentGrantEndpoint=this.getAttribute('data-consentGrantEndpoint');this.userIdentifier=this.getAttribute('data-userIdentifier');this.branding={img:{src:JSON.parse(this.getAttribute('data-branding'))?.img?.src?`<img src="${JSON.parse(this.getAttribute('data-branding'))?.img?.src}" alt="${JSON.parse(this.getAttribute('data-branding'))?.img?.alt||''}" />`:b,alt:JSON.parse(this.getAttribute('data-branding'))?.img?.alt,size:{width:JSON.parse(this.getAttribute('data-branding'))?.img?.size?.width||'70px',height:JSON.parse(this.getAttribute('data-branding'))?.img?.size?.height||'70px',translateY:JSON.parse(this.getAttribute('data-branding'))?.img?.size?.translateY||'30%'}},colors:{primary:JSON.parse(this.getAttribute('data-branding'))?.colors?.primary||'#00A2AE',secondary:JSON.parse(this.getAttribute('data-branding'))?.colors?.secondary||'#17243F',tertiary:JSON.parse(this.getAttribute('data-branding'))?.colors?.tertiary||'#08FFAD',quaternary:JSON.parse(this.getAttribute('data-branding'))?.colors?.quaternary||'#DBFFAA',gradient:JSON.parse(this.getAttribute('data-branding'))?.colors?.gradient||'linear-gradient(to right, #DBFFAA, #00A2AE, #08FFAD)',bgOpacity:JSON.parse(this.getAttribute('data-branding'))?.colors?.bgOpacity||'#08FFAD1f',buttonText:{initial:JSON.parse(this.getAttribute('data-branding'))?.colors?.buttonText?.initial||'#000000',hover:JSON.parse(this.getAttribute('data-branding'))?.colors?.buttonText?.hover||'#ffffff'},active:{background:JSON.parse(this.getAttribute('data-branding'))?.colors?.active?.background||'#00A2AE',text:JSON.parse(this.getAttribute('data-branding'))?.colors?.active?.text||'#000000'}}};this.demo=this.getAttribute('data-demo')||'false';this.modalContent='choose';this.render()}async getPrivacyNotice(A){if(A){try {var _=await fetch(A,{headers:{Authorization:`Bearer ${this.PDCAdminJWT}`}});return await _.json()} catch (B) {console.error('Error fetching JSON:',B)}return}if(this.demo=='true')return JSON.parse(a);try {var _=await fetch(this.privacyNoticeEndpoint);return await _.json()} catch (C) {console.error('Error fetching JSON:',C)}}async getAvailableExchanges(){try {var _a=await fetch(this.availableExchangesEndpoint,{headers:{Authorization:`Bearer ${this.PDCAdminJWT}`}});return _a?.json()} catch (D) {console.error('Error fetching JSON:',D)}}async getContracts(_A){try {var _b=_A?.exchanges?.map(async e=>{const _B=await fetch(e.contract);const _c=await _B.json();const _d=[];for(const aA in _c)aA=='dataProvider'||aA=='dataConsumer'||aA=='ecosystem'&&_d.push((async ()=>{const aB=await fetch(_c[aA]);_c[aA]=await aB.json()})());await Promise.all(_d);const E=await (async ()=>{const aC=e?.participantSelfDescription?.includes('https');if(!aC)return;const aD=await fetch(e?.participantSelfDescription);return await aD.json()})();return{consumer:E,contracts:_c}});return await Promise.all(_b)} catch (aE) {console.error('Error fetching contracts:',aE);throw aE}}async getPrivacyNotices(aF){try {var aG=aF?.content?.map(async aH=>{aH.recipients=await Promise.all(aH.recipients?.map(async r=>{const aI=await fetch(r);return aI.json()}));aH.purposes=await Promise.all(aH.purposes?.map(async p=>{const aJ=await fetch(p.purpose);return aJ.json()}));return aH});return await Promise.all(aG)} catch (aK) {console.error('Error fetching privacy notices:',aK)}}async render(){if(this.PDCAdminJWT&&this.availableExchangesEndpoint){try {var aL=await this.getAvailableExchanges();var aM=await this.getContracts(aL?.content);this.contracts=await aM;this.renderData('',aL?.content);return} catch (aN) {console.error('Error:',aN)}return}try {var _C=await this.getPrivacyNotice();this.renderData(_C)} catch (aO) {console.error('Error:',aO)}}handleSelectExchange(aP){this.activeExchange=aP}renderStyleModal(){var aQ=document.createElement('style');aQ.textContent=`
              @font-face {
                font-family: 'KoHo';
                src: url('${c.bold}'),
                    url('${c.boldItalic}'),
                    url('${c.extraLight}'),
                    url('${c.extraLightItalic}'),
                    url('${c.italic}'),
                    url('${c.light}'),
                    url('${c.lightItalic}'),
                    url('${c.semiBold}'),
                    url('${c.semiBoldItalic}'),
                    url('${c.regular}'),
                    url('${c.medium}'),
                    url('${c.mediumItalic}');
              }

              #modal-backdrop {
                  font-family: "KoHo", sans-serif;
                  display: none;
                  align-items: flex-start;
                  position: fixed;
                  inset: 0;
                  overflow-y: auto;
                  background-color: rgba(0, 0, 0, 0.5);
                  z-index: 9998;
                  min-height: 100vh;
                  padding-inline: 0.5rem;
              }

              #button-open-modal {
                font-family: "KoHo", sans-serif;
                border: 1px solid #fefefe;
                background-color: ${this.branding.colors.primary};
                color: ${this.branding.colors.buttonText.initial};
                padding: 0.6rem 1rem;
                cursor: pointer;
                transition: all 0.1s ease-in-out;
                border-radius: 5px;
              }
              #button-open-modal:hover {
                background-color: ${this.branding.colors.secondary};
                color: ${this.branding.colors.buttonText.hover};
              }

              #consent-modal {
                  font-family: "KoHo", sans-serif;
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  text-align: center;
                  position: relative;
                  background-color: #fefefe;
                  margin-block: 30px;
                  z-index: 9999;
                  cursor: initial;
                  border-radius: 15px;
                  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
                  overflow: hidden;
                  width: 100%;
                  margin-inline: auto;
                  min-width: 250px;
                  max-width: 900px;
                  -webkit-animation-name: animatetop;
                  -webkit-animation-duration: 0.4s;
                  animation-name: animatetop;
                  animation-duration: 0.4s;
              }

              .consent-modal-bg-head {
                  position: relative;
                  background: ${this.branding.colors.gradient||this.branding.colors.primary};
                  width: 100%;
                  min-height: 56px;
                  border-bottom: 5px solid ${this.branding.colors.secondary};
                  margin-bottom: 35px;
              }

              .consent-modal-head-logo {
                  width: ${this.branding.img.size.width};
                  height: ${this.branding.img.size.height};
                  position: absolute;
                  margin-left: auto;
                  margin-right: auto;
                  left: 0;
                  right: 0;
                  text-align: center;
                  transform: translateY(${this.branding.img.size.translateY});
              }
              .consent-modal-head-logo img, .consent-modal-head-logo  svg {
                width: ${this.branding.img.size.width};
                height: ${this.branding.img.size.height};
                max-width: ${this.branding.img.size.width};
                min-width: ${this.branding.img.size.width};
                min-height: ${this.branding.img.size.height};
                max-height: ${this.branding.img.size.height};
                object-fit: contain;
              }

              .consent-modal-close {
                  position: absolute;
                  top: 10px;
                  right: 10px;
                  color: #fefefe;
                  cursor: pointer;
                  font-size: 2rem;
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  width: 35px;
                  height: 35px;
                  min-width: 35px;
                  min-height: 35px;
                  transition: all 0.1s ease-in-out;
                  border-radius: 3px;
              }
              .consent-modal-close svg {
                  transition: all 0.2s ease-in;
              }
              .consent-modal-close:hover svg {
                  transform: scale(1.03);
              }

              .consent-modal-header h3 {
                  font-size: 20px;
                  font-weight: bold;
              }
              .consent-modal-header .consent-modal-header-purpose {
                  color: ${this.branding.colors.primary};
                  font-size: 24px;
                  margin-top: 5px;
              }
              .consent-modal-header-purpose-sub {
                  font-size: 18px;
              }

              .consent-modal-body {
                  display: flex;
                  flex-direction: column;
                  align-items: center;
                  margin-block: 30px;
                  gap: 16px;
                  max-width: 600px;
              }
              .consent-modal-body-exchange {
                  display: flex;
                  align-items: flex-start;
                  justify-content: space-between;
                  gap: 20px;
                  width: 100%;
              }
              .consent-modal-body-exchange svg {
                  transform: translateY(30px);
                  min-width: 30px;
              }
              .consent-modal-body-exchange-participant {
                  display: flex;
                  align-items: center;
                  flex-direction: row;
                  justify-content: center;
                  gap: 5px;
              }
              .consent-modal-body-provider, .consent-modal-body-consumer {
                  display: flex;
                  align-items: center;
                  flex-direction: row;
                  justify-content: center;
                  flex-wrap: wrap;
                  gap: 12px;
              }
              .controller-identify {
                  display: flex;
                  align-items: center;
                  flex-direction: column;
                  justify-content: flex-start;
                  gap: 12px;
                  text-align: start;
              }
              .participant-logo {
                border: 2px solid ${this.branding.colors.primary};
                background: #ffffff;
                width: 80px;
                min-width: 80px;
                max-width: 80px;
                height: 80px;
                min-height: 80px;
                max-height: 80px;
                aspect-ratio: 1/1;
                border-radius: 15px;
                object-fit: contain;
              }
              .pdi-container {
                display: flex;
                flex-direction: column;
                width: 100%;
                align-items: flex-start;
                text-align: start;
                gap: 4px;
              }
              .pdi-container h4 {
                font-size: 20px;
              }
              .pdi-container h5 {
                font-size: 18px;
                color: ${this.branding.colors.primary};
              }
              .organisations-container {
                display: flex;
                flex-direction: column;
                align-items: stretch;
                gap: 24px;
              }
              .organisations-container h4 {
                font-weight: bold;
                font-size: 20px;
                margin-bottom: 8px;
              }
              .consent-modal-legal-container, .consent-modal-learn-more-container {
                  display: flex;
                  flex-direction: column;
                  width: 100%;
                  align-items: flex-start;
                  text-align: start;
                  gap: 12px;
              }
              .consent-modal-legal-data {
                  display: flex;
                  flex-direction: column;
                  width: 100%;
              }
              .consent-modal-legal-main-title {
                  font-weight: bold;
                  font-size: 20px;
              }
              .consent-modal-legal-information-title {
                  font-size: 18px;
              }
              .consent-modal-legal-information-link {
                  color: ${this.branding.colors.primary};
                  text-decoration: none;
              }
              .consent-modal-legal-information-link:hover {
                  text-decoration: underline;
              }

              .consent-modal-footer {
                  display: flex;
                  align-items: center;
                  flex-direction: column;
                  gap: 16px;
              }
              .consent-modal-footer-buttons {
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  gap: 24px;
                  flex-wrap: wrap;
              }
              .consent-modal-footer button {
                  border-radius: 65px;
                  border: none;
                  cursor: pointer;
                  font-size: 18px;
                  padding: 12px 24px;
                  min-width: 150px;
                  font-weight: 500;
              }
              #btn-consent, .btn-next, .btn-next-notice, .btn-close {
                  background: ${this.branding.colors.primary};
                  border: 1px solid ${this.branding.colors.primary};
                  transition: all 0.1s ease-in;
                  color: ${this.branding.colors.buttonText.initial};
              }
              #btn-decline {
                  background: #ffffff;
                  border: 1px solid ${this.branding.colors.primary};
                  transition: all 0.1s ease-in;
              }
              #btn-consent:hover, #btn-decline:hover, .btn-next:hover, .btn-next-notice:hover, .btn-close:hover {
                background: ${this.branding.colors.secondary};
                border-color: ${this.branding.colors.secondary};
                color: ${this.branding.colors.buttonText.hover};
              }
              .btn-next, .btn-next-notice {
                margin-block: 12px;
              }

              .consent-modal-select-contracts {
                margin-block: 12px;
              }

              .consent-modal-extra {
                  width: 100%;
                  display: flex;
                  align-items: center;
                  margin-top: 20px;
              }
              .consent-modal-extra button {
                  width: calc(100% /3);
                  border: none;
                  border-top: 1px solid ${this.branding.colors.secondary};
                  background: #ffffff;
                  border-left: 1px solid ${this.branding.colors.secondary};
                  cursor: pointer;
                  padding: 0px;
                  height: 40px;
              }
              .consent-modal-extra .active {
                  background: ${this.branding.colors.primary};
                  color: ${this.branding.colors.buttonText.initial};
              }
              .consent-modal-extra button:first-child {
                  border-left: 0;
              }

              .consent-modal-body-shared {
                  display: flex;
                  flex-direction: column;
                  align-items: stretch;
                  text-align: start;
                  gap: 16px;
                  width: 100%;
              }
              .consent-modal-body-shared h4 {
                  text-align: center;
                  width: 100%;
                  font-size: 20px;
              }
              .purpose-container, .bi-lateral, .dsuc, .privacy-notice-container {
                  display: flex;
                  flex-direction: column;
                  gap: 16px;
                  background: ${this.branding.colors.bgOpacity};
                  padding: 10px;
                  border-radius: 15px;
              }
              .bi-lateral, .dsuc {
                width: 100%;
              }
              .purpose-obligation {
                  text-align: center;
                  font-weight: bold;
              }
              .purpose-information {
                  display: flex;
                  flex-direction: column;
                  gap: 4px;
                  font-size: 14px;
                  width: 100%;
              }
              .purpose-information h5 {
                  font-size: 18px;
              }
              .purpose-sr {
                  display: flex;
                  flex-direction: row;
                  align-items: flex-start;
                  justify-content: space-between;
                  gap: 16px;
              }
              .purpose-sr-information {
                  display: flex;
                  flex-direction: column;
                  gap: 8px;
                  font-size: 14px;
              }
              .purpose-sr-information-name {
                  font-size: 16px;
                  font-weight: 600;
              }
              .switch {
                  position: relative;
                  display: inline-block;
                  width: 40px;
                  height: 24px;
              }
              .switch-content {
                  display: flex;
                  align-items: center;
                  gap: 10px;
              }
              .switch .switch-input {
                  display: none;
              }
              .switch .switch-label {
                  position: absolute;
                  top: 0;
                  left: 0;
                  width: 40px;
                  height: 20px;
                  background-color: grey;
                  border-radius: 20px;
                  cursor: pointer;
                  transition: background-color 0.3s;
              }
              .switch .switch-label::before {
                  content: '';
                  position: absolute;
                  width: 16px;
                  height: 16px;
                  border-radius: 50%;
                  top: 2px;
                  left: 3px;
                  background-color: #ffffff;
                  box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.3);
                  transition: transform 0.3s;
              }
              .switch .switch-input:checked + .switch-label::before {
                  transform: translateX(18px);
              }
              .switch .switch-input:checked + .switch-label {
                  background: ${this.branding.colors.tertiary};
              }

              details {
                border-bottom: 1px solid ${this.branding.colors.bgOpacity};
                width: 100%;
              }
              details summary {
                  width: 100%;
                  list-style: none;
                  display: flex;
                  align-items: center;
                  justify-content: space-between;
                  cursor: pointer;
                  font-weight: bold;
                  transition: all 0.1s ease;
              }
              details summary svg {
                  transition: transform 0.1s ease-in;
                  transform: rotate(0deg);
              }
              details summary svg:hover {
                  background: grey;
                  border-radius: 5px;
              }
              details > div {
                  opacity: 0;
                  transform: translateY(-10px);
                  transition: all 0.2s ease-out;
                  text-align: start;
              }
              details[open] {
                  padding-bottom: 10px;
              }
              details[open] > summary {
                color: ${this.branding.colors.primary};
              }
              details[open] > summary svg {
                  transform: rotate(-180deg);
              }
              details[open] > div {
                  opacity: 1;
                  transform: translateY(0);
              }
              .card-toggle {
                background: ${this.branding.colors.bgOpacity};
                padding: 10px;
                border-radius: 15px;
                border: none;
                width: auto;
              }
              .card-toggle > summary > span {
                display: flex;
                gap: 12px;
                align-items: center;
                text-transform: uppercase;
                color: initial;
                transition: all 0.1s ease;
              }
              .card-toggle[open] summary span {
                color: ${this.branding.colors.primary};
              }
              .card-toggle[open] > div {
                padding-top: 12px;
              }

              .purpose-data-sharing > summary {
                font-size: 18px;
                font-weight: bold;
                color: #000000;
              }
              .purpose-data-sharing > div, .your-data-sharing {
                display: flex;
                flex-direction: column;
                align-items: stretch;
                gap: 4px;
                padding-block: 10px;
              }
              .purpose-data-sharing[open] > summary {
                color: #000000;
              }
              .your-data-sharing  {
                padding: 0;
              }

              .data-sharing, .data-sharing-content {
                display: flex;
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
              }
              .data-sharing-content {
                gap: 24px;
              }

              .data-sharing h5 {
                font-size: 18px;
                font-weight: 600;
              }

              .card-toggle-data {
                font-size: 16px;
              }

              .participant-information {
                display: flex;
                flex-direction: column;
                align-items: start;
                gap: 4px;
                text-align: start;
              }
              .participant-information p:last-child {
                text-transform: initial;
                font-weight: 500;
                font-size: 14px;
              }

              .consent-modal-body-email, .consent-modal-body-email-inputs {
                  display: flex;
                  align-items: center;
                  flex-direction: column;
                  gap: 8px;
              }
              #email-custom {
                  padding: 8px 12px;
                  border-radius: 5px;
                  border: 1px solid ${this.branding.colors.secondary}
              }
              .checkbox-wrapper-input {
                  display: none;
                  visibility: hidden;
              }
              .checkbox-wrapper-input:checked + .checkbox-wrapper-label .checkbox-wrapper-custom-input {
                 background: ${this.branding.colors.primary};
                 border-color: ${this.branding.colors.primary};
              }
              .checkbox-wrapper-input:checked + .checkbox-wrapper-label .checkbox-wrapper-custom-input svg {
                 stroke-dashoffset: 0;
              }
              .checkbox-wrapper-label {
                  display: inline-flex;
                  justify-content: flex-start;
                  align-items: center;
                  vertical-align: bottom;
                  margin: auto;
                  user-select: none;
                  -webkit-user-select: none;
                  cursor: pointer;
              }
              .checkbox-wrapper-label:hover .checkbox-wrapper-custom-input {
                  border-color: ${this.branding.colors.primary};
              }
              .checkbox-wrapper-label span {
                  display: inline-flex;
                  justify-content: center;
                  align-items: center;
                  vertical-align: middle;
                  transform: translate3d(0, 0, 0);
              }
              .checkbox-wrapper-custom-input {
                  position: relative;
                  border-radius: 3px;
                  transform: scale(1);
                  vertical-align: middle;
                  border: 1px solid grey;
                  transition: all 0.2s ease;
                  width: 14px;
                  height: 14px;
              }
              .checkbox-wrapper-custom-input svg {
                  fill: none;
                  stroke: #ffffff;
                  stroke-width: 2;
                  stroke-linecap: round;
                  stroke-linejoin: round;
                  stroke-dasharray: 16px;
                  stroke-dashoffset: 16px;
                  transition: all 0.3s ease;
                  transition-delay: 0.1s;
                  transform: translate3d(0, 0, 0);
              }
              .checkbox-wrapper-content {
                  font-size: 14px;
                  padding-left: 8px;
              }

              .consent-modal-footer-certified {
                  display: flex;
                  align-items: center;
                  gap: 4px;
              }

              .logo-certified svg, .logo-certified img {
                  width: 25px;
                  height: 25px;
                  max-width: 25px;
                  min-width: 25px;
                  min-height: 25px;
                  max-height: 25px;
              }
              .logo-certified {
                  width: 25px;
                  height: 25px;
                  max-width: 25px;
                  min-width: 25px;
                  min-height: 25px;
                  max-height: 25px;
              }

              h3, h4, h5, p {
                  margin: 0;
              }

              .consent-modal-header, .consent-modal-body, .consent-modal-footer {
                  width: calc(100% - 20px);
                  margin-inline: 10px;
              }

              .button-disabled {
                background: grey !important;
                border-color: grey !important;
                pointer-events: none;
              }

              .simple-loader {
                display: inline-flex;
                width: 15px;
                height: 15px;
                border-radius: 50%;
                position: relative;
                animation: rotate 1s linear infinite;
              }
              .simple-loader::before {
                content: '';
                box-sizing: border-box;
                position: absolute;
                inset: 0px;
                border-radius: 50%;
                border: 3px solid #fff;
                animation: prixClipFix 2s linear infinite;
              }

              .contract-item {
                cursor: pointer;
                border-radius: 5px;
                text-align: start;
                display: flex;
                flex-direction: row;
                justify-content: space-around;
                flex-wrap: wrap;
                padding: 8px;
                gap: 12px;
              }
              .contract-item:hover {
                background: ${this.branding.colors.active.background}20;
              }
              .contract-active {
                background: ${this.branding.colors.active.background};
                color: ${this.branding.colors.active.text};
              }
              .contract-active:hover {
                background: ${this.branding.colors.active.background};
                color: ${this.branding.colors.active.text};
              }

              .consent-modal-select-privacy-notice {
                align-items: stretch;
              }
              .privacy-notice-container {
                cursor: pointer;
                border-radius: 5px;
                padding: 8px;
                gap: 12px;
              }
              .privacy-notice-container:hover {
                background: ${this.branding.colors.active.background}20;
              }
              .privacy-notice-container-active {
                background: ${this.branding.colors.active.background};
                color: ${this.branding.colors.active.text};
              }
              .privacy-notice-container-active:hover {
                background: ${this.branding.colors.active.background};
                color: ${this.branding.colors.active.text};
              }

              .inner-toggle {
                margin-block: 4px;
              }

              @keyframes rotate {
                  100% {
                      transform: rotate(360deg);
                  }
              }
              @keyframes prixClipFix {
                  0% {
                      clip-path: polygon(50% 50%, 0 0, 0 0, 0 0, 0 0, 0 0);
                  }
                  25% {
                      clip-path: polygon(50% 50%, 0 0, 100% 0, 100% 0, 100% 0, 100% 0);
                  }
                  50% {
                      clip-path: polygon(50% 50%, 0 0, 100% 0, 100% 100%, 100% 100%, 100% 100%);
                  }
                  75% {
                      clip-path: polygon(50% 50%, 0 0, 100% 0, 100% 100%, 0 100%, 0 100%);
                  }
                  100% {
                      clip-path: polygon(50% 50%, 0 0, 100% 0, 100% 100%, 0 100%, 0 0);
                  }
              }

              @-webkit-keyframes animatetop {
                  from {transform: translateY(-100px); opacity:0}
                  to {transform: translateY(0); opacity:1}
              }

              @keyframes animatetop {
                  from {transform: translateY(-100px); opacity:0}
                  to {transform: translateY(0); opacity:1}
              }
          `;return aQ}renderConsentModalBgHeader(){var aR=`
              <div class="consent-modal-bg-head">
                  <slot name="modal-close-icon">
                      <span class="consent-modal-close">
                          <svg
                          width="24"
                          height="24"
                          viewBox="0 0 24 24"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                          >
                              <path
                              d="M20.4896 20.4896C25.1779 15.8012 25.1779 8.19988 20.4896 3.51152C15.8012 -1.17684 8.19988 -1.17684 3.51152 3.51152C-1.17684 8.19988 -1.17684 15.8012 3.51152 20.4896C8.19988 25.1779 15.8012 25.1779 20.4896 20.4896Z"
                              fill="black"
                              fill-opacity="0.84"
                              />
                              <path
                              fill-rule="evenodd"
                              clip-rule="evenodd"
                              d="M11.0495 15.2133L15.2133 11.0495L18.4978 7.76493C19.1201 7.1426 19.1201 6.12454 18.4978 5.50221C17.8755 4.87988 16.8574 4.87988 16.2351 5.50221L12.9505 8.78668L8.78668 12.9505L5.50221 16.2351C4.87988 16.8574 4.87988 17.8755 5.50221 18.4978C6.12454 19.1201 7.1426 19.1201 7.76493 18.4978L11.0495 15.2133Z"
                              fill="white"
                              />
                              <path
                              fill-rule="evenodd"
                              clip-rule="evenodd"
                              d="M15.2133 12.9505L11.0495 8.78668L7.76493 5.50221C7.1426 4.87988 6.12454 4.87988 5.50221 5.50221C4.87988 6.12454 4.87988 7.1426 5.50221 7.76493L8.78668 11.0495L12.9505 15.2133L16.2351 18.4978C16.8574 19.1201 17.8755 19.1201 18.4978 18.4978C19.1201 17.8755 19.1201 16.8574 18.4978 16.2351L15.2133 12.9505Z"
                              fill="white"
                              />
                          </svg>
                      </span>
                  </slot>
                  <span class="consent-modal-head-logo">${this.branding.img.src}</span>
              </div>
          `;return aR}renderConsentModalHeader(aS,aT){var aU=`
              <div class="consent-modal-header">
                  <slot name="modal-title">
                      <h3>Sharing your personal data for the purpose of</h3>
                  </slot>
                  <slot name="purpose-title"><h3 class="consent-modal-header-purpose">${aS?.content?.purposes?.[0]?.name}</h3></slot>
              </div>
          `;var _D=`
              <h3 class="consent-modal-header-purpose">Discover how your data will be used</h3>
          `;var _e=`
              <h3 class="consent-modal-header-purpose">Legal aspects of your consent</h3>
              <p class="consent-modal-header-purpose-sub">Understanding your data rights empowers you to take control of your personal information.</p>
          `;var f=`
        <div class="consent-modal-header">
          <h3 class="consent-modal-header-purpose">Select your exchange contract</h3>
        </div>
      `;var g=`
          <div class="consent-modal-header">
            <h3 class="consent-modal-header-purpose">Select your privacy notice</h3>
          </div>
      `;var h=`
          <div class="consent-modal-header success">
            <h3 class="consent-modal-header-purpose">Congrat you consent was successfuly create.</h3>  
          </div>
      `;var i={choose:aU,learnMore:_D,legal:_e,chooseExchange:f,choosePrivacyNotice:g,success:h};return i[aT]}renderConsentModalBody(aV,aW,aX){var aY=`
        <div class="consent-modal-body consent-modal-select-privacy-notice">
          ${aX?.map(aZ=>`
              <div class="privacy-notice-container" id="${aZ?._id}">
                  <div>
                    ${aZ?.recipients?.map(r=>`
                        <p>
                          ${r?.legalName}
                        </p>
                        `)}
                  </div>
                  ${aZ?.purposes?.map(p=>`<div>
                          <div>
                              <h5>${p?.name}</h5>
                              <span>${p?.description}</span>
                          </div>
                      </div>`).join('')}
              </div>
            `).join('')}
        </div>
      `;var _E=`
      <div class="consent-modal-body consent-modal-select-contracts">
          <div class="bi-lateral">
              <h4>Bi lateral contracts</h4>
              ${this.contracts?.map(bA=>{const bB=bA?.contracts?.dataProvider?.legalName,bC=bA?.consumer?.legalName;if(!bC||!bB)return;return`
                          <div class="contract-item" id="${bA?.contracts?._id}">
                              <div>${bB}</div>
                              <div>${bC}</div>
                          </div>
                      `}).join('')}
          </div>
          <div class="dsuc">
              <h4>Data space use case contracts</h4>
              ${this.contracts?.map(bD=>{const bE=bD?.contracts?.ecosystem?.name,bF=bD?.consumer?.legalName;if(!bE)return;return`
                    <div class="contract-item" id="${bD?.contracts?._id}">
                        <p>${bE}</p>
                        <div>${bF}</div>
                    </div>
                  `}).join('')}
          </div>
      </div>
    `;var F=`
          <div class="consent-modal-learn-more-container">
            <div class="organisations-container">
              <div>
                <h4>Organisations involved</h4>
                <div class="organisation-content">
                  ${aV?.content?.recipients?.map(r=>`
                        <details class="card-toggle">
                          <summary>
                            <span>
                              <img class="participant-logo" src="${r?.logo?.includes('https')?r?.logo:`https://api.visionstrust.com/images/${r?.logo}`}"  alt="logo ${r?.legalName}" />
                              <span class="participant-information">
                                <p>
                                  ${r?.legalName}
                                </p>
                                <p>
                                  Why is your data used?
                                </p>
                              </span>
                            </span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>
                          </summary>
                          <div>
                            ${aV?.content?.purposes?.map(p=>`
                                <div>
                                  <p><b>${p?.name}</b></p>
                                  <p>${p?.description}</p>
                                  <p><b>You can find this data here:</b> ${p?.location}</p>
                                </div>
                              `)}
                          </div>
                      </details>
                      `)}
              </div>
            </div>
            <div class="data-sharing">
              <div>
                <h4>Data sharing</h4>
                <h5>Your data</h5>
              </div>
                <div class="data-sharing-content">
                <div class="your-data-sharing">
                  ${aV?.content?.data?.map(d=>`
                      <details class="card-toggle-data">
                        <summary>
                          <span>${d?.name}</span>
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>
                        </summary>
                        <div>
                          <p>${d?.description}</p>
                          <p><b>You can find this data here:</b> ${d?.location}</p>
                          ${d?.softwareResources?.map(bG=>`
                          <details class="card-toggle-data inner-toggle">
                            <summary>
                              <span>${bG?.name}</span>
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>
                            </summary>
                            <div>
                              <p>${bG?.description}</p>
                            </div>
                          </details>
                          `)}
                      ${d?.dataResources?.map(bH=>`
                          <details class="card-toggle-data inner-toggle">
                            <summary>
                              <span>${bH?.name}</span>
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg>
                            </summary>
                            <div>
                              <p>${bH?.description}</p>
                            </div>
                          </details>
                          `)}
                        </div>
                      </details>
                      `)}
                </div>
              </div>
            </div>

            <div class="pdi-container">
              <h4>Personal Data intermediary</h4>
              <h5>VISIONSTRUST</h5>
              <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation</p>
            </div>
          </div>
          `;var G=[{mainTitle:'Consent',information:[{title:'What is consent?',description:'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.',link:'#'},{title:'How to exercise the right to withdraw consent?',description:'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.',link:'#'}]},{mainTitle:'Methods of Data Processing and Collection',information:[{title:'',description:'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.',link:'#'}]},{mainTitle:'Data Localization',information:[{title:'',description:'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.',link:'#'}]},{mainTitle:'Data storage',information:[{title:'Duration',description:'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.',link:'#'},{title:'Geolocation',description:'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.',link:'#'}]},{mainTitle:'Third-party services',information:[{title:'Organisation name',description:'Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.',link:'#'}]}],k={choose:I,learnMore:F,chooseExchange:_E,choosePrivacyNotice:aY,legal:H,success:j};var H=`
          <div class="consent-modal-legal-container">
              ${G.map(bI=>`
                      <div class="consent-modal-legal-data">
                          <h4 class="consent-modal-legal-main-title">${bI.mainTitle}</h4>
                          <div class="consent-modal-legal-information">
                              ${bI.information.map(bJ=>`
                                      ${bJ.title&&`<h5 class="consent-modal-legal-information-title">${bJ.title}</h5>`}
                                      <p class="consent-modal-legal-information-description">${bJ.description} ${bJ.link&&`<a href="${bJ.link}" target="_blank" class="consent-modal-legal-information-link">See more</a>`}</p>
                                  `).join('')}
                          </div>
                      </div>
                  `).join('')}
          </div>
      `;var I=`
          <div class="consent-modal-body">
              <div class="consent-modal-body-exchange">
                  <div class="consent-modal-body-exchange-participant">
                      <div class="consent-modal-body-provider">
                          <img class="participant-logo" <img class="participant-logo" src="${aV?.content?.dataProvider?.logo?.includes('https')?aV?.content?.dataProvider?.logo:`https://api.visionstrust.com/images/${aV?.content?.dataProvider?.logo}`}" alt="Logo ${aV?.content?.dataProvider?.legalName}">
                          <div class="controller-identify">
                              <span>${aV?.content?.dataProvider?.legalName}</span>
                              <span>Controller's identify</span>
                          </div>
                      </div>
                  </div>
                  <slot name="exchange-icon">
                      <svg width="41" height="16" viewBox="0 0 41 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M40.7071 8.70711C41.0976 8.31658 41.0976 7.68342 40.7071 7.29289L34.3431 0.928932C33.9526 0.538408 33.3195 0.538408 32.9289 0.928932C32.5384 1.31946 32.5384 1.95262 32.9289 2.34315L38.5858 8L32.9289 13.6569C32.5384 14.0474 32.5384 14.6805 32.9289 15.0711C33.3195 15.4616 33.9526 15.4616 34.3431 15.0711L40.7071 8.70711ZM0 9H40V7H0V9Z" fill="${this.branding.colors.primary}"/>
                      </svg>
                  </slot>
                  <div class="consent-modal-body-exchange-participant">
                      ${aV?.content?.recipients?.map(r=>`
                              <div class="consent-modal-body-consumer">
                                  <img class="participant-logo" <img class="participant-logo" src="${r?.logo?.includes('https')?r?.logo:`https://api.visionstrust.com/images/${r?.logo}`}" alt="logo ${r?.legalName}" />
                                  <div class="controller-identify">
                                      <span>${r?.legalName}</span>
                                      <span>Controller's identify</span>
                                  </div>
                              </div>
                          `)}
                  </div>
              </div>
              <div class="consent-modal-body-shared">
                  <h4>Select the data to share</h4>
                  ${aV?.content?.data?.map(d=>`<div class="purpose-container">
                          <p class="purpose-obligation">Requested</p>
                          <div class="purpose-information">
                              <h5>${d?.name}</h5>
                              <span>${d?.description}</span>
                          </div>
                          <div class="purpose-sr">
                              ${d?.softwareResources?.map(bK=>`
                                  <div class="purpose-sr-information">
                                      <span class="purpose-sr-information-name">${bK?.name}</span>
                                      <span>${bK?.description}</span>
                                  </div>
                                  `)}
                          </div>
                          <div>
                              ${d?.dataResources?.map(bL=>`
                                  <div class="purpose-sr">
                                      <div class="purpose-sr-information">
                                          <span class="purpose-sr-information-name">${bL?.name}</span>
                                          <span>${bL?.description}</span>
                                      </div>
                                  </div>
                                  `)}
                          </div>
                      </div>`)}
              </div>
              <div class="consent-modal-body-email">
                  <h4>Are your using another email for your account on ${aV?.content?.dataProvider?.legalName}</h4>
                  <p>Please specify if there is another email associated with your account on ${aV?.content?.dataProvider?.legalName}. Otherwise, indicate that you do not have one.</p>
                  <div class="consent-modal-body-email-inputs">
                      <input type="email" placeholder="Email" id="email-custom" name="email-custom" />
                      <div class="checkbox-wrapper">
                          <input
                              type="checkbox"
                              id="checkbox-trigger"
                              name="checkbox-trigger"
                              class="checkbox-wrapper-input"
                          />
                          <label for="checkbox-trigger" class="checkbox-wrapper-label">
                              <span class="checkbox-wrapper-custom-input">
                                  <svg viewBox="0 0 12 10" height="10px" width="12px">
                                      <polyline points="1.5 6 4.5 9 10.5 1"></polyline>
                                  </svg>
                              </span>
                              <span class="checkbox-wrapper-content">I do not have an account on ${aV?.content?.dataProvider?.legalName}</span>
                          </label>
                      </div>
                  </div>
              </div>
          </div>
          `;var j=`
          <div></div>
      `;return k[aW]}renderConsentModalFooter(bM){var bN=`
        <div class="consent-modal-footer">
            <div class="consent-modal-footer-buttons">
                <button class="btn-next-notice button-disabled" disabled>Next</button>
            </div>
        </div>
      `;var bO=`
        <div class="consent-modal-footer">
            <div class="consent-modal-footer-buttons">
                <button class="btn-next button-disabled" disabled>Next</button>
            </div>
        </div>
      `;var bP=`
        <div class="consent-modal-footer">
            <div class="consent-modal-footer-buttons">
                <button class="btn-close">I understand</button>
            </div>
        </div>
      `;var bQ=`
          <div class="consent-modal-footer">
              <div class="consent-modal-footer-buttons">
                  <slot name="btn-consent"><button id="btn-consent">Agree</button></slot>
                  <slot name="btn-decline"><button id="btn-decline">Decline</button></slot>
              </div>
              <div class="consent-modal-footer-certified">
                  Certified consents by <span class="logo-certified">${b}</span> <b>Visionstrust</b>
              </div>
          </div>
          `;return bM=='chooseExchange'?bO:bM=='choosePrivacyNotice'?bN:bM=='success'?bP:bQ}renderConsentModalExtra(bR){var bS=`
              <div class="consent-modal-extra">
                  <button class="btn-choose active">Share my data</button>
                  <button class="btn-learn-more">Learn more</button>
                  <button class="btn-legal">Legal</button>
              </div>
          `;return bR=='chooseExchange'||bR=='success'?'<div class="consent-modal-extra"></div>':bS}renderSimpleLoader(){return`<span class="simple-loader"></span>`}renderLogicButtonConsent(bT,bU,bV){var bW=bT?.querySelector('#btn-consent'),bX=bT?.querySelectorAll('.switch-input'),_f=bT?.querySelector('#email-custom');bW?.addEventListener('click',async ()=>{bW.setAttribute('disabled','');bW.classList.add('button-disabled');var bY=bW.innerHTML,bZ=RegExp(/^((?!\.)[\w.\-]*[^.])(@\w+)(\.\w+(\.\w+)?\w)$/gm),cA=[],_h=this.renderConsentModalExtra(this.modalContent),_i=bT.querySelector('.btn-close');bW.innerHTML=this.renderSimpleLoader();bX?.forEach(s=>cA.push({_id:s?.name.split('_')[1],checked:s?.checked}));if(_f?.value!==''&&!bZ.test(_f?.value)){bW.removeAttribute('disabled');bW.classList.remove('button-disabled');bW.innerHTML=bY;return alert('Invalid email')}var cB=await fetch(this.consentGrantEndpoint,{body:JSON.stringify({privacyNoticeId:bU?.content?._id,userId:this.userIdentifier,email:_f?.value||''}),headers:{'content-type':'application/json'},method:'POST'});if(!cB)throw Error('Failed to post the current consent');setTimeout(()=>{bW.removeAttribute('disabled');bW.classList.remove('button-disabled');bW.innerHTML=bY},2000);this.modalContent='success';var cC=await this.renderConsentModalHeader('',this.modalContent);var _F=await this.renderConsentModalBody('',this.modalContent);var _g=await this.renderConsentModalFooter(this.modalContent);bV.header.innerHTML=cC;bV.body.innerHTML=_F;bV.footer.innerHTML=_g;bV.extra.innerHTML=_h;_i?.addEventListener('click',()=>bV.backdrop.style.display='none')})}renderLogicButtonDecline(cD,cE){var cF=cD?.querySelector('#btn-decline');cF?.addEventListener('click',()=>cE.style.display='none')}async renderData(cG,cH){this.privacyNotice=cG;var cI=document.createElement('link'),cJ=document.createElement('div'),cK=document.createElement('article'),cL=document.createElement('slot'),_G=document.createElement('button'),_H=this.renderConsentModalBgHeader(),_I=this.renderConsentModalHeader(this.privacyNotice,this.modalContent),K=this.renderConsentModalFooter(this.modalContent),l=this.renderConsentModalExtra(this.modalContent),m=cK.querySelector('#btn-decline'),n=cK.querySelector('#btn-consent'),o=cK.querySelector('.btn-next'),P=cK.querySelector('.consent-modal-close'),q=cK.querySelector('.consent-modal-header'),R=cK.querySelector('.consent-modal-body'),S=cK.querySelector('.consent-modal-footer'),t=cK.querySelector('.consent-modal-extra'),u=cK.querySelector('#email-custom'),v=cK.querySelectorAll('.switch-input'),w=cK.querySelectorAll('.consent-modal-extra button'),x=cK.querySelectorAll('.contract-item');cI.setAttribute('rel','stylesheet');cI.setAttribute('href','https://fonts.googleapis.com/css2?family=KoHo:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600;1,700&display=swap');document.head.appendChild(cI);cJ.classList.add('modal-backdrop');cJ.setAttribute('id','modal-backdrop');cK.classList.add('consent-modal');cK.setAttribute('id','consent-modal');cL.setAttribute('name','buttonOpenModal');_G.textContent='Open Modal';_G.setAttribute('id','button-open-modal');cL.appendChild(_G);cH&&!this.privacyNotice&&(this.modalContent='chooseExchange');var J=await this.renderConsentModalBody(this.privacyNotice,this.modalContent);cK.innerHTML='';cK.innerHTML=_H+_I+J+K+l;cJ.appendChild(cK);cL.addEventListener('click',()=>cJ.style.display='block');x?.forEach(cM=>cM.addEventListener('click',()=>{for(const cN of x)cN.classList.remove('contract-active');this.activeExchange=cM?.getAttribute('id');cM.classList.add('contract-active');this.activeExchange&&(o.removeAttribute('disabled',''),o.classList.remove('button-disabled'))}));o?.addEventListener('click',async ()=>{o.setAttribute('disabled','');o.classList.add('button-disabled');var cO=o.innerHTML,cP=cH?.exchanges?.find(cT=>cT?.contract?.includes(this.activeExchange)),cS=cK.querySelector('.btn-next-notice');o.innerHTML=this.renderSimpleLoader();if(!cP){o.removeAttribute('disabled');o.classList.remove('button-disabled');o.innerHTML=cO;return}this.privacyNoticeEndpoint=cP?.privacyNoticeEndpoint;var cQ=await fetch(cP?.privacyNoticeEndpoint?.replace('{userId}',this.userIdentifier),{headers:{Authorization:`Bearer ${this.PDCAdminJWT}`}});var cR=await cQ.json();this.privacyNotices=await cR;this.modalContent='choosePrivacyNotice';o.removeAttribute('disabled');o.classList.remove('button-disabled');o.innerHTML=cO;q.innerHTML=await this.renderConsentModalHeader('',this.modalContent);R.innerHTML=await this.renderConsentModalBody('',this.modalContent,await this.getPrivacyNotices(this.privacyNotices));S.innerHTML=await this.renderConsentModalFooter(this.modalContent);this.privacyNoticesItems=cK.querySelectorAll('.privacy-notice-container');this.privacyNoticesItems?.forEach(cU=>cU?.addEventListener('click',()=>{this.privacyNoticesItems?.forEach(cV=>cV?.classList?.remove('privacy-notice-container-active'));this.activeNotice=cU?.getAttribute('id');cU.classList.add('privacy-notice-container-active');this.activeNotice&&(cS.removeAttribute('disabled',''),cS?.classList.remove('button-disabled'))}));cS?.addEventListener('click',async ()=>{cS.setAttribute('disabled','');cS.classList.add('button-disabled');var cW=cS.innerHTML,cX=this.availableExchangesEndpoint.split('/consent')[0],dA=cK?.querySelectorAll('.consent-modal-extra button');cS.innerHTML=this.renderSimpleLoader();var cY=await fetch(`${cX}/consent/${this.userIdentifier}/privacy-notices/${this.activeNotice}`);var cZ=await cY.json();if(!cZ){cS.removeAttribute('disabled');cS.classList.remove('button-disabled');cS.innerHTML=cW;return}this.modalContent='choose';this.privacyNotice=cZ;cS.removeAttribute('disabled');cS.classList.remove('button-disabled');cS.innerHTML=cW;q.innerHTML=await this.renderConsentModalHeader(this.privacyNotice,this.modalContent);R.innerHTML=await this.renderConsentModalBody(this.privacyNotice,this.modalContent);S.innerHTML=await this.renderConsentModalFooter(this.modalContent);t.innerHTML=this.renderConsentModalExtra(this.modalContent);dA?.forEach(dB=>dB.addEventListener('click',()=>{for(const dC of dA)dC.classList.remove('active');dB.classList.contains('btn-choose')?this.modalContent='choose':dB.classList.contains('btn-learn-more')?this.modalContent='learnMore':dB.classList.contains('btn-legal')&&(this.modalContent='legal');dB.classList.add('active');q.innerHTML=this.renderConsentModalHeader(this.privacyNotice,this.modalContent);R.innerHTML=this.renderConsentModalBody(this.privacyNotice,this.modalContent);S.innerHTML=this.renderConsentModalFooter(this.modalContent);this.renderLogicButtonConsent(cK,this.privacyNotice,{header:q,body:R,footer:S,extra:t,backdrop:cJ});this.renderLogicButtonDecline(cK,cJ)}));this.renderLogicButtonConsent(cK,this.privacyNotice,{header:q,body:R,footer:S,extra:t,backdrop:cJ});this.renderLogicButtonDecline(cK,cJ)})});w?.forEach(dD=>dD.addEventListener('click',()=>{for(const dE of w)dE.classList.remove('active');dD.classList.contains('btn-choose')?this.modalContent='choose':dD.classList.contains('btn-learn-more')?this.modalContent='learnMore':dD.classList.contains('btn-legal')&&(this.modalContent='legal');dD.classList.add('active');q.innerHTML=this.renderConsentModalHeader(this.privacyNotice,this.modalContent);R.innerHTML=this.renderConsentModalBody(this.privacyNotice,this.modalContent);S.innerHTML=this.renderConsentModalFooter(this.modalContent);this.renderLogicButtonConsent(cK,this.privacyNotice,{header:q,body:R,footer:S,extra:t,backdrop:cJ});this.renderLogicButtonDecline(cK,cJ)}));m?.addEventListener('click',()=>cJ.style.display='none');P?.addEventListener('click',()=>cJ.style.display='none');n?.addEventListener('click',async ()=>{n.setAttribute('disabled','');n.classList.add('button-disabled');var dF=n.innerHTML,dG=RegExp(/^((?!\.)[\w.\-]*[^.])(@\w+)(\.\w+(\.\w+)?\w)$/gm),dH=[],dJ=cK.querySelector('.btn-close');n.innerHTML=this.renderSimpleLoader();v?.forEach(s=>dH.push({_id:s?.name.split('_')[1],checked:s?.checked}));if(u?.value!==''&&!dG.test(u?.value)){n.removeAttribute('disabled');n.classList.remove('button-disabled');n.innerHTML=dF;return alert('Invalid email')}var dI=await fetch(this.consentGrantEndpoint,{method:'POST',body:JSON.stringify({privacyNoticeId:cG?.content?._id,userId:this.userIdentifier,email:u?.value||''}),headers:{'content-type':'application/json'}});if(!dI)throw Error('Failed to post the current consent');setTimeout(()=>{n.removeAttribute('disabled');n.classList.remove('button-disabled');n.innerHTML=dF},2000);this.modalContent='success';q.innerHTML=await this.renderConsentModalHeader('',this.modalContent);R.innerHTML=await this.renderConsentModalBody('',this.modalContent);S.innerHTML=await this.renderConsentModalFooter(this.modalContent);t.innerHTML=this.renderConsentModalExtra(this.modalContent);dJ?.addEventListener('click',()=>cJ.style.display='none')});this.shadowRoot.innerHTML='';this.shadowRoot.appendChild(this.renderStyleModal());this.shadowRoot.appendChild(cL);this.shadowRoot.appendChild(cJ)}}customElements.define('consent-modal',ConsentModal);
